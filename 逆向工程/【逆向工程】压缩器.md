# 【逆向工程】压缩器

## 有损压缩

有损压缩： **压缩时舍弃部分人类不敏感的数据 → 解压后不能完全恢复原始数据。**

### 常见有损压缩算法

（1）JPEG（图像）

- DCT（离散余弦变换）
- 量化矩阵（丢弃高频）
- 熵编码（霍夫曼）
- 高速，压缩率高

（2）MP3 / AAC（音频）

- 频域变换（MDCT）
- 心理声学模型（丢弃听不见的部分）
- 量化
- 熵编码

（3）H.264、H.265、AV1（视频）

- 每帧都进行：
  - 分块
  - 运动估计（预测）
  - 变换（DCT/整数变换）
  - 量化（信息丢失）
  - CABAC/CAVLC 熵编码
- 压缩率极高，是流媒体基础

## 无损压缩

无损压缩指： **压缩后可以 100% 无差恢复原始数据，没有任何信息丢失。**

### 常见无损压缩算法

（1）Huffman Coding（霍夫曼编码）

- 构造二叉树，频率高的字符用较短的编码
- 基于变长前缀码
- 多用于 ZIP、PNG、GZIP

（2）LZ77 / LZ78 系列（字典压缩）

- 建立“字典”，用“引用”替代重复内容
- 是无损压缩史上最重要的算法体系
- 实现：
  - **LZ77**（滑动窗口）
  - **LZ78**（显式字典）
  - **LZW**（LZ78改进，GIF 使用）
  - **DEFLATE**（LZ77 + Huffman，ZIP/PNG 使用）

（3）Arithmetic Coding（算术编码）

- 用区间表示概率，压缩效率比霍夫曼更高
- 视频编码、PNG、JPEG2000 使用

（4）Run Length Encoding（RLE，游程编码）

- 类似："AAAAA" → "A×5"
- 简单高效，适用于重复数据多的场景
- BMP、TIFF、早期传真

## 运行时压缩器

运行时压缩器（Runtime Packer / Executable Packer）：把可执行文件（EXE / DLL）的代码与数据在磁盘上“压缩”或“加密”，运行时再由“解压 stub（壳代码）”把它还原到内存中执行的工具或技术。

文件在**运行前**是被压缩的。程序**运行时（runtime）**由一个小的“壳 stub”**自动解压**恢复成原始代码

> UPX 就是最经典的运行时压缩器。

